# Set the application name
spring.application.name=api-gateway

# Set the port for the gateway. This is the single entry point.
server.port=8080

# === Eureka Client Configuration ===
# Tell the gateway where the discovery server is
eureka.client.service-url.defaultZone=http://eureka:password@localhost:8761/eureka
# We want it to register itself with Eureka
eureka.client.register-with-eureka=true
# We want it to fetch the list of other services
eureka.client.fetch-registry=true

# === Gateway Routing Configuration ===

# --- Route for product-service ---
# We give our route a unique ID
spring.cloud.gateway.routes[0].id=product-service
# 'lb://product-service' means "find the service named 'product-service' in Eureka and forward to it"
spring.cloud.gateway.routes[0].uri=lb://product-service
# This is the "Predicate". It "matches" incoming requests.
# This says: "match any request whose path starts with /api/product/"
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/product/**

# --- Route for order-service ---
# A unique ID for the order route
spring.cloud.gateway.routes[1].id=order-service
# 'lb://order-service' means "find the service named 'order-service' in Eureka and forward to it"
spring.cloud.gateway.routes[1].uri=lb://order-service
# This predicate matches any request whose path starts with /api/order/
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/order/**

# --- IMPORTANT NOTE ---
# Notice we are NOT creating a route for 'inventory-service'.
# This is a good thing! It means the public cannot access our inventory service directly.
# Only the 'order-service' can communicate with it internally.
# This is a major security benefit of using an API Gateway.

# ... your existing properties ...

# === Security Configuration ===
# Tell the gateway where to find the Keycloak server
# It will use this one URL to discover all other security endpoints
spring.security.oauth2.resourceserver.jwt.issuer-uri=http://localhost:8181/realms/spring-boot-microservices-realm

# === Zipkin Tracing Configuration ===
# Tell the service where the Zipkin server is
spring.zipkin.base-url=http://localhost:9411

# Tell Micrometer to trace 100% of requests (replaces Sleuth's sampler.probability)
management.tracing.sampling.probability=1.0